# ---------------------------------------------------------------------------
# compliance-check-weekly.yml
# ---------------------------------------------------------------------------
# Weekly orchestration trigger for live Companies House compliance checks
# Runs every Monday at 10:00 UTC
# ---------------------------------------------------------------------------
# Co-authored-by: system operator <wanda@openai.com>
# Co-authored-by: system administrator <Corvin Nehal Dhali> <info@eckohaus.co.uk>
# ---------------------------------------------------------------------------

name: Compliance Check (Weekly Live Monitor)

on:
  schedule:
    - cron: "0 10 * * 1"  # Every Monday at 10:00 UTC
  workflow_dispatch:  # Optional manual trigger

permissions:
  contents: write  # Required for ledger updates

jobs:
  run-weekly-check:
    name: Weekly CH Live Compliance Run
    uses: ./.github/workflows/compliance-check-live.yml
    secrets: inherit

    # -----------------------------------------------------------------------
    # Optional: Append a "next scheduled run" note to orchestration-ledger.md
    # Enable once filing cadence tracking or jurisdictional scheduling expands.
    # -----------------------------------------------------------------------
    # steps:
    #   - name: Append next run reminder
    #     if: success()
    #     run: |
    #       NEXT_RUN=$(date -u -d "+7 days" +"%Y-%m-%d 10:00 UTC")
    #       echo "| $(date -u +'%Y-%m-%d %H:%M UTC') | Next scheduled CH check | ${NEXT_RUN} |" >> orchestration-ledger.md
    #       echo "ğŸ—“ï¸ Logged next run: ${NEXT_RUN}"
